<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>üß¨ Reto del Carbono-14</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Arial, sans-serif;
      background-color: black;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-size: cover;
      background-position: center;
    }

    /* Pantalla de inicio */
    #pantallaInicio {
      background-image: url("fondo_inicio.jpg");
      background-size: cover;
      background-position: center;
      text-align: center;
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    #pantallaInicio h1 {
      font-size: 40px;
      text-shadow: 2px 2px 5px black;
      background: rgba(0, 0, 0, 0.6);
      padding: 10px 20px;
      border-radius: 10px;
    }

    #pantallaInicio button {
      margin-top: 20px;
      padding: 12px 25px;
      font-size: 18px;
      border-radius: 12px;
      border: none;
      background-color: #28a745;
      color: white;
      cursor: pointer;
    }

    #pantallaInicio button:hover {
      background-color: #1e7e34;
    }

    /* Caja del juego */
    .fossil-box {
      display: none;
      background-color: rgba(0, 0, 0, 0.7);
      border-radius: 20px;
      padding: 20px;
      width: 420px;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
      text-align: center;
    }

    #imagenFosil {
      width: 100%;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      margin: 5px;
    }

    button:hover {
      background-color: #218838;
    }

    input {
      padding: 5px;
      border-radius: 8px;
      border: none;
      text-align: center;
      width: 200px;
    }

    #mensaje {
      font-size: 18px;
      margin-top: 15px;
      white-space: pre-line;
    }

    #puntaje {
      margin-top: 10px;
      font-size: 20px;
      font-weight: bold;
    }

    #explicacion {
      display: none;
      margin-top: 20px;
      background: rgba(255, 255, 255, 0.1);
      padding: 10px;
      border-radius: 10px;
      text-align: left;
      font-size: 14px;
    }

    #reanudarBtn {
      background-color: #007bff;
    }

    #reanudarBtn:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <!-- Pantalla de inicio -->
  <div id="pantallaInicio">
    <h1>üßë‚Äçüî¨ Dataci√≥n de carbono-14 en distintos f√≥siles</h1>
    <button onclick="iniciarJuego()">Comenzar</button>
  </div>

  <!-- Pantalla del juego -->
  <div class="fossil-box" id="pantallaJuego">
    <h2 id="tituloFosil">F√≥sil 1</h2>
    <img id="imagenFosil" src="" alt="Imagen del f√≥sil">
    <p>Fracci√≥n medida: <strong id="fraccionMedida"></strong></p>
    <input id="edadInput" type="number" placeholder="Edad estimada (a√±os)">
    <br><br>
    <button onclick="verificar()">Verificar</button>
    <button id="siguienteBtn" onclick="siguiente()" style="display:none;">Siguiente</button>
    <button id="reanudarBtn" onclick="reanudar()" style="display:none;">Reanudar</button>
    <p id="mensaje"></p>
    <p id="puntaje"></p>
    <div id="explicacion"></div>
  </div>

  <script>
    const lambda = Math.log(2) / 5730; // Constante de desintegraci√≥n
    const MAX_INTENTOS = 5;

    // Lista de f√≥siles (nombres iguales a tus archivos)
    let fosiles = [
      { nombre: "F√≥sil de mamut", imagen: "Mamut.jpg" },
      { nombre: "F√≥sil de ave", imagen: "ave.jpg" },
      { nombre: "F√≥sil de planta 1", imagen: "planta.jpg" },
      { nombre: "F√≥sil de planta 2", imagen: "planta1.jpg" },
      { nombre: "F√≥sil de dientes de sable", imagen: "Dientes_de_sable.jpg" },
      { nombre: "F√≥sil de insecto en √°mbar", imagen: "Insecto_Ambar.jpg" },
      { nombre: "F√≥sil de tiranosaurio", imagen: "Tiranosaurio.jpg" },
      { nombre: "F√≥sil de triceratops", imagen: "Triceratops.jpg" }
    ];

    // Variables de control
    let indiceActual = 0;
    let puntaje = 0;
    let intentos = 0;

    // üîÄ Funci√≥n para mezclar los f√≥siles aleatoriamente
    function mezclarFosiles(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function iniciarJuego() {
      fosiles = mezclarFosiles(fosiles).map(f => ({
        ...f,
        fraccion: Math.random() * 0.9 + 0.05 // nueva fracci√≥n aleatoria por f√≥sil
      }));

      indiceActual = 0;
      puntaje = 0;
      intentos = 0;

      document.getElementById("pantallaInicio").style.display = "none";
      document.body.style.backgroundImage = 'url("Fondo_lab.jpg")';
      document.getElementById("pantallaJuego").style.display = "block";
      mostrarFosil();
    }

    function mostrarFosil() {
      const f = fosiles[indiceActual];
      document.getElementById("tituloFosil").textContent = f.nombre;
      document.getElementById("fraccionMedida").textContent = f.fraccion.toFixed(3);
      document.getElementById("imagenFosil").src = f.imagen;
      document.getElementById("mensaje").textContent = "";
      document.getElementById("edadInput").value = "";
      document.getElementById("siguienteBtn").style.display = "none";
      document.getElementById("reanudarBtn").style.display = "none";
      document.getElementById("explicacion").style.display = "none";
      document.getElementById("puntaje").textContent = `Puntaje: ${puntaje}`;
    }

    function verificar() {
      if (intentos >= MAX_INTENTOS) {
        alert("‚ö†Ô∏è Alcanzaste el m√°ximo de intentos (5).");
        finalizar();
        return;
      }

      const edadInput = parseFloat(document.getElementById("edadInput").value);
      if (isNaN(edadInput)) {
        alert("‚ö†Ô∏è Ingresa una edad v√°lida.");
        return;
      }

      intentos++;

      const f = fosiles[indiceActual];
      const edadReal = -Math.log(f.fraccion) / lambda;
      const error = Math.abs((edadReal - edadInput) / edadReal) * 100;
      let mensaje = "";

      if (error <= 10) {
        puntaje += 25;
        mensaje = `‚úÖ ¬°Excelente! Error de ${error.toFixed(1)}%`;
        mostrarExplicacion(f.fraccion, edadReal);
      } else if (error <= 30) {
        puntaje += 15;
        mensaje = `üü° Casi aciertas. Error de ${error.toFixed(1)}%`;
        mostrarExplicacion(f.fraccion, edadReal);
      } else {
        mensaje = `‚ùå Error alto (${error.toFixed(1)}%)`;
      }

      mensaje += `\nüß† Edad real: ${edadReal.toFixed(0)} a√±os`;
      mensaje += `\nüî¢ Intento ${intentos} de ${MAX_INTENTOS}`;
      document.getElementById("mensaje").textContent = mensaje;
      document.getElementById("siguienteBtn").style.display = "inline";
      document.getElementById("puntaje").textContent = `Puntaje: ${puntaje}`;

      if (intentos >= MAX_INTENTOS) finalizar();
    }

    function mostrarExplicacion(fraccion, edadReal) {
      const exp = document.getElementById("explicacion");
      exp.style.display = "block";
      exp.innerHTML = `
      <strong>üìò Explicaci√≥n cient√≠fica:</strong><br><br>
      La desintegraci√≥n del carbono-14 sigue una <strong>ecuaci√≥n diferencial de primer orden</strong>:<br>
      <code>dN/dt = -ŒªN</code><br><br>
      Su soluci√≥n general es:<br>
      <code>N(t) = N‚ÇÄ e<sup>-Œªt</sup></code><br><br>
      Donde Œª es la constante de desintegraci√≥n.<br>
      Si dividimos entre N‚ÇÄ:<br>
      <code>f = N/N‚ÇÄ = e<sup>-Œªt</sup></code><br>
      Tomando logaritmos:<br>
      <code>t = -ln(f) / Œª</code><br><br>
      En este caso:<br>
      <code>t = -ln(${fraccion.toFixed(3)}) / ${lambda.toExponential(4)} ‚âà ${edadReal.toFixed(0)} a√±os</code><br>
      `;
    }

    function siguiente() {
      indiceActual++;
      if (indiceActual < fosiles.length) {
        mostrarFosil();
      } else {
        finalizar();
      }
    }

    function finalizar() {
      const porcentaje = (puntaje / (fosiles.length * 25)) * 100;
      let mensajeFinal = "";

      if (intentos >= MAX_INTENTOS) {
        mensajeFinal = `üö´ Se agotaron los intentos (${MAX_INTENTOS}).`;
      } else if (porcentaje >= 50) {
        mensajeFinal = `üèÜ ¬°Felicidades! Has ganado con ${porcentaje.toFixed(1)}%.`;
      } else {
        mensajeFinal = `üíÄ Has perdido con ${porcentaje.toFixed(1)}%. Intenta de nuevo.`;
      }

      document.getElementById("mensaje").textContent = mensajeFinal;
      document.getElementById("siguienteBtn").style.display = "none";
      document.getElementById("reanudarBtn").style.display = "inline";
      document.getElementById("explicacion").style.display = "block";
      document.getElementById("explicacion").innerHTML = `
        <strong>üí° ¬øPor qu√© estos resultados?</strong><br>
        Los f√≥siles se datan con la ecuaci√≥n diferencial <code>dN/dt = -ŒªN</code>, cuya soluci√≥n
        permite calcular el tiempo seg√∫n la fracci√≥n de Carbono-14 restante.
      `;
    }

    function reanudar() {
      iniciarJuego();
    }
  </script>
</body>
</html>
